import{c as n,i as A,s as $}from"./job-6fa85dd5.js";import{t as i}from"./translate-ea8f1c55.js";import{f as m}from"./lobby-76e50ffd.js";import"./config-b9844f25.js";let a=null;const c=(e=["excavationZone"],o=null)=>{if(n("makeExcavation"))for(let r=0;r<e.length;r++)WA.state[`${e[r]}Discovered`]?WA.room.showLayer(`${e[r]}/found`):(WA.room.showLayer(`${e[r]}/trace`),WA.room.onEnterLayer(`${e[r]}/trace`).subscribe(()=>{WA.state[`${e[r]}Discovered`]||(a=WA.ui.displayActionMessage({message:i("utils.executeAction",{action:i("modules.excavation.makeExcavations")}),callback:()=>{WA.state[`${e[r]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e[r]}/trace`).subscribe(()=>{a==null||a.remove()}),WA.state.onVariableChange(`${e[r]}Discovered`).subscribe(()=>{u(e[r],o?o[r]:null)}))},u=(e,o=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),o&&o()},1e3)},3e3)};let l=null;const W=e=>{const o=[];for(let r=1;r<31;r++)for(let t=1;t<21;t++)o.push({x:r,y:t,tile:null,layer:`${e}/block`});WA.room.setTiles(o),console.log("salut")},d=(e=["secretPassageZone"],o=null)=>{if(n("findSecretPassages"))for(let r=0;r<e.length;r++)WA.state[`${e[r]}Discovered`]?(WA.room.showLayer(`${e[r]}/found`),WA.room.hideLayer(`${e[r]}/disappear`)):(WA.room.showLayer(`${e[r]}/trace`),WA.room.onEnterLayer(`${e[r]}/trace`).subscribe(()=>{WA.state[`${e[r]}Discovered`]||(l=WA.ui.displayActionMessage({message:i("utils.executeAction",{action:i("modules.secretPassage.findSecretPassage")}),callback:()=>{WA.state[`${e[r]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e[r]}/trace`).subscribe(()=>{l==null||l.remove()}),WA.state.onVariableChange(`${e[r]}Discovered`).subscribe(()=>{y(e[r],o?o[r]:null)}))},y=(e,o=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),WA.room.hideLayer(`${e}/disappear`),W(e),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),o&&o()},1e3)},3e3)},L=e=>{for(let o=0;o<e.length;o++)WA.room.onEnterLayer(e[o].stepIn).subscribe(()=>{WA.room.hideLayer(e[o].hide)}),WA.room.onLeaveLayer(e[o].stepIn).subscribe(()=>{WA.room.showLayer(e[o].hide)})},h=(e=["switchingTiles"])=>{for(let o=0;o<e.length;o++){const r=JSON.parse(WA.state[`${e[o]}VictoryCondition`]);for(let t=0;t<Object.keys(r).length;t++)console.log(`${e[o]}/${t}_layer/zone`),WA.room.onEnterLayer(`${e[o]}/${t}_layer/zone`).subscribe(()=>{console.log("entered layer");let s=WA.state[`${e[o]}_${t}_value`]?WA.state[`${e[o]}_${t}_value`]:0;WA.state[`${e[o]}_${t}_value`]=(s+1)%3,WA.room.hideLayer(`${e[o]}/${t}_layer`),WA.room.showLayer(`${e[o]}/${t}_layer/${WA.state[`${e[o]}_${t}_value`]}`),console.log("changed tile value to : "+WA.state[`${e[o]}_${t}_value`])})}};WA.onInit().then(()=>{console.log("INITIALISATION"),A(),$("spy"),console.log("HERE"),c(["excavation"],[()=>{console.log("test callback after excavation")}]),d(["secretPassage"],[()=>{console.log("test callback after finding secret passage")}]),L([{stepIn:"hiddenZoneFloor",hide:"hiddenZoneTop"}]),console.log("Initiate switching tiles"),h(),console.log("LOBBY INITIALISATION"),m()}).catch(e=>console.error(e));
